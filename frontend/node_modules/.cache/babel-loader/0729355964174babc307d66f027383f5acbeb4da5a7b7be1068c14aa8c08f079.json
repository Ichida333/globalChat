{"ast":null,"code":"import _slicedToArray from\"/Users/ichidayu/globalChat/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useRef,useState}from\"react\";import{Button,Col,Form,Row}from\"react-bootstrap\";import\"./MessageForm.css\";import{useSelector}from\"react-redux\";import{AppContext}from\"../context/appContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var MessageForm=function MessageForm(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var _useContext=useContext(AppContext),socket=_useContext.socket,currentRoom=_useContext.currentRoom,setMessages=_useContext.setMessages,messages=_useContext.messages,privateMemberMsg=_useContext.privateMemberMsg;var user=useSelector(function(state){return state.user;});function handleSubmit(e){e.preventDefault();}function getFormattedDate(){var date=new Date();var year=date.getFullYear();var month=(1+date.getMonth()).toString();month=month.length>1?month:\"0\"+month;var day=date.getDate().toString();day=day.length>1?day:\"0\"+day;return month+\"/\"+day+\"/\"+year;}var todayDate=getFormattedDate();socket.off(\"room-messages\").on(\"room-messages\",function(roomMessages){console.log(\"room messages\",roomMessages);setMessages(roomMessages);});function handleSubmit(e){e.preventDefault();if(!message)return;var today=new Date();var minutes=today.getMinutes()<10?\"0\"+today.getMinutes():today.getMinutes();var time=today.getHours()+\":\"+minutes;var roomId=currentRoom;socket.emit(\"message-room\",roomId,message,user,time,todayDate);setMessage(\"\");}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"messages-output\",children:[user&&!(privateMemberMsg!==null&&privateMemberMsg!==void 0&&privateMemberMsg._id)&&currentRoom.length==0&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info\",children:\"Let's Talk!!\"}),user&&!(privateMemberMsg!==null&&privateMemberMsg!==void 0&&privateMemberMsg._id)&&currentRoom.length!==0&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-info\",children:[\"You are in the \",currentRoom,\" room\"]}),user&&(privateMemberMsg===null||privateMemberMsg===void 0?void 0:privateMemberMsg._id)&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info conversation-info\",children:/*#__PURE__*/_jsxs(\"div\",{children:[\"Your conversation with \",privateMemberMsg.name,\" \",/*#__PURE__*/_jsx(\"img\",{src:privateMemberMsg.picture,className:\"conversation-profile-pic\"})]})})}),!user&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:\"Please login\"}),user&&messages.map(function(_ref,idx){var date=_ref._id,messagesByDate=_ref.messagesByDate;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"alert alert-info text-center message-date-indicator\",children:date}),messagesByDate===null||messagesByDate===void 0?void 0:messagesByDate.map(function(_ref2,msgIdx){var content=_ref2.content,time=_ref2.time,sender=_ref2.from;return/*#__PURE__*/_jsx(\"div\",{className:(sender===null||sender===void 0?void 0:sender.email)==(user===null||user===void 0?void 0:user.email)?\"message\":\"incoming-message\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"message-inner\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center mb-3\",children:[/*#__PURE__*/_jsx(\"img\",{src:sender.picture,style:{width:35,height:35,objectFit:\"cover\",borderRadius:\"50%\",marginRight:10}}),/*#__PURE__*/_jsx(\"p\",{className:\"message-sender\",children:sender._id==(user===null||user===void 0?void 0:user._id)?\"You\":sender.name})]}),/*#__PURE__*/_jsx(\"p\",{className:\"message-content\",children:content}),/*#__PURE__*/_jsx(\"p\",{className:\"message-timestamp-left\",children:time})]})},msgIdx);})]},idx);})]}),/*#__PURE__*/_jsx(Form,{onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:11,children:/*#__PURE__*/_jsx(Form.Group,{children:/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Your message\",disabled:!user,value:message,onChange:function onChange(e){return setMessage(e.target.value);}})})}),/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",style:{width:\"100%\",backgroundColor:\"orange\"},disabled:!user,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-paper-plane\"})})})]})})]});};export default MessageForm;","map":{"version":3,"names":["React","useContext","useEffect","useRef","useState","Button","Col","Form","Row","useSelector","AppContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MessageForm","_useState","_useState2","_slicedToArray","message","setMessage","_useContext","socket","currentRoom","setMessages","messages","privateMemberMsg","user","state","handleSubmit","e","preventDefault","getFormattedDate","date","Date","year","getFullYear","month","getMonth","toString","length","day","getDate","todayDate","off","on","roomMessages","console","log","today","minutes","getMinutes","time","getHours","roomId","emit","children","className","_id","name","src","picture","map","_ref","idx","messagesByDate","_ref2","msgIdx","content","sender","from","email","style","width","height","objectFit","borderRadius","marginRight","onSubmit","md","Group","Control","type","placeholder","disabled","value","onChange","target","variant","backgroundColor"],"sources":["/Users/ichidayu/globalChat/frontend/src/components/MessageForm.js"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from \"react\";\nimport { Button, Col, Form, Row } from \"react-bootstrap\";\nimport \"./MessageForm.css\";\nimport { useSelector } from \"react-redux\";\nimport { AppContext } from \"../context/appContext\";\n\n\nconst MessageForm = () => {\n  const [message, setMessage] = useState(\"\");\n  \n  const { socket, currentRoom, setMessages, messages, privateMemberMsg } = useContext(AppContext);\n  const user = useSelector((state) => state.user);\n\n  function handleSubmit(e) {\n    e.preventDefault();\n  }\n\n  function getFormattedDate() {\n    const date = new Date();\n    const year = date.getFullYear();\n    let month = (1 + date.getMonth()).toString();\n\n    month = month.length > 1 ? month : \"0\" + month;\n    let day = date.getDate().toString();\n\n    day = day.length > 1 ? day : \"0\" + day;\n\n    return month + \"/\" + day + \"/\" + year;\n}\n\nconst todayDate = getFormattedDate();\n\nsocket.off(\"room-messages\").on(\"room-messages\", (roomMessages) => {\n  console.log(\"room messages\",roomMessages);\n  setMessages(roomMessages);\n});\n\n\nfunction handleSubmit(e) {\n  e.preventDefault();\n  if (!message) return;\n  const today = new Date();\n  const minutes = today.getMinutes() < 10 ? \"0\" + today.getMinutes() : today.getMinutes();\n  const time = today.getHours() + \":\" + minutes;\n  const roomId = currentRoom;\n  socket.emit(\"message-room\", roomId, message, user, time, todayDate);\n  setMessage(\"\");\n}\n \n\n  return (\n    <>\n            <div className=\"messages-output\">\n            {user && !privateMemberMsg?._id && currentRoom.length == 0 &&<div className=\"alert alert-info\">Let's Talk!!</div>}\n            {user && !privateMemberMsg?._id && currentRoom.length !== 0 &&<div className=\"alert alert-info\">You are in the {currentRoom} room</div>}\n                {user && privateMemberMsg?._id && (\n                    <>\n                        <div className=\"alert alert-info conversation-info\">\n                            <div>\n                                Your conversation with {privateMemberMsg.name} <img src={privateMemberMsg.picture} className=\"conversation-profile-pic\" />\n                            </div>\n                        </div>\n                    </>\n                )}\n                {!user && <div className=\"alert alert-danger\">Please login</div>}\n\n                {user &&\n                    messages.map(({ _id: date, messagesByDate }, idx) => (\n                      <div key={idx}>\n                      <p className=\"alert alert-info text-center message-date-indicator\">{date}</p>\n                      {messagesByDate?.map(({ content, time, from: sender }, msgIdx) => (\n                          <div className={sender?.email == user?.email ? \"message\" : \"incoming-message\"} key={msgIdx}>\n                              <div className=\"message-inner\">\n                                  <div className=\"d-flex align-items-center mb-3\">\n                                      <img src={sender.picture} style={{ width: 35, height: 35, objectFit: \"cover\", borderRadius: \"50%\", marginRight: 10 }} />\n                                      <p className=\"message-sender\">{sender._id == user?._id ? \"You\" : sender.name}</p>\n                                  </div>\n                                  <p className=\"message-content\">{content}</p>\n                                  <p className=\"message-timestamp-left\">{time}</p>\n                              </div>\n                          </div>\n                      ))}\n                  </div>\n              ))}\n          {/* <div ref={messageEndRef} /> */}\n      </div>\n            <Form onSubmit={handleSubmit}>\n              <Row>\n              <Col md={11}>\n                <Form.Group>\n                  <Form.Control type=\"text\" placeholder=\"Your message\" disabled={!user} value={message} onChange={(e) => setMessage(e.target.value)}>\n\n\n                  </Form.Control>\n                </Form.Group>\n              </Col>\n              <Col md={1}>\n              <Button variant=\"primary\" type=\"submit\" style={{ width: \"100%\", backgroundColor: \"orange\" }} disabled={!user}>\n              <i className=\"fas fa-paper-plane\"></i>\n              </Button>\n              </Col>\n              </Row>\n            </Form>\n          \n                \n           \n        </>\n  )\n}\n\nexport default MessageForm\n"],"mappings":"yHAAA,MAAO,CAAAA,KAAK,EAAIC,UAAU,CAAEC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CACtE,OAASC,MAAM,CAAEC,GAAG,CAAEC,IAAI,CAAEC,GAAG,KAAQ,iBAAiB,CACxD,MAAO,mBAAmB,CAC1B,OAASC,WAAW,KAAQ,aAAa,CACzC,OAASC,UAAU,KAAQ,uBAAuB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAGnD,GAAM,CAAAC,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAA,CAAS,CACxB,IAAAC,SAAA,CAA8Bd,QAAQ,CAAC,EAAE,CAAC,CAAAe,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAnCG,OAAO,CAAAF,UAAA,IAAEG,UAAU,CAAAH,UAAA,IAE1B,IAAAI,WAAA,CAAyEtB,UAAU,CAACS,UAAU,CAAC,CAAvFc,MAAM,CAAAD,WAAA,CAANC,MAAM,CAAEC,WAAW,CAAAF,WAAA,CAAXE,WAAW,CAAEC,WAAW,CAAAH,WAAA,CAAXG,WAAW,CAAEC,QAAQ,CAAAJ,WAAA,CAARI,QAAQ,CAAEC,gBAAgB,CAAAL,WAAA,CAAhBK,gBAAgB,CACpE,GAAM,CAAAC,IAAI,CAAGpB,WAAW,CAAC,SAACqB,KAAK,QAAK,CAAAA,KAAK,CAACD,IAAI,GAAC,CAE/C,QAAS,CAAAE,YAAYA,CAACC,CAAC,CAAE,CACvBA,CAAC,CAACC,cAAc,CAAC,CAAC,CACpB,CAEA,QAAS,CAAAC,gBAAgBA,CAAA,CAAG,CAC1B,GAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,IAAI,CAAC,CAAC,CACvB,GAAM,CAAAC,IAAI,CAAGF,IAAI,CAACG,WAAW,CAAC,CAAC,CAC/B,GAAI,CAAAC,KAAK,CAAG,CAAC,CAAC,CAAGJ,IAAI,CAACK,QAAQ,CAAC,CAAC,EAAEC,QAAQ,CAAC,CAAC,CAE5CF,KAAK,CAAGA,KAAK,CAACG,MAAM,CAAG,CAAC,CAAGH,KAAK,CAAG,GAAG,CAAGA,KAAK,CAC9C,GAAI,CAAAI,GAAG,CAAGR,IAAI,CAACS,OAAO,CAAC,CAAC,CAACH,QAAQ,CAAC,CAAC,CAEnCE,GAAG,CAAGA,GAAG,CAACD,MAAM,CAAG,CAAC,CAAGC,GAAG,CAAG,GAAG,CAAGA,GAAG,CAEtC,MAAO,CAAAJ,KAAK,CAAG,GAAG,CAAGI,GAAG,CAAG,GAAG,CAAGN,IAAI,CACzC,CAEA,GAAM,CAAAQ,SAAS,CAAGX,gBAAgB,CAAC,CAAC,CAEpCV,MAAM,CAACsB,GAAG,CAAC,eAAe,CAAC,CAACC,EAAE,CAAC,eAAe,CAAE,SAACC,YAAY,CAAK,CAChEC,OAAO,CAACC,GAAG,CAAC,eAAe,CAACF,YAAY,CAAC,CACzCtB,WAAW,CAACsB,YAAY,CAAC,CAC3B,CAAC,CAAC,CAGF,QAAS,CAAAjB,YAAYA,CAACC,CAAC,CAAE,CACvBA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,GAAI,CAACZ,OAAO,CAAE,OACd,GAAM,CAAA8B,KAAK,CAAG,GAAI,CAAAf,IAAI,CAAC,CAAC,CACxB,GAAM,CAAAgB,OAAO,CAAGD,KAAK,CAACE,UAAU,CAAC,CAAC,CAAG,EAAE,CAAG,GAAG,CAAGF,KAAK,CAACE,UAAU,CAAC,CAAC,CAAGF,KAAK,CAACE,UAAU,CAAC,CAAC,CACvF,GAAM,CAAAC,IAAI,CAAGH,KAAK,CAACI,QAAQ,CAAC,CAAC,CAAG,GAAG,CAAGH,OAAO,CAC7C,GAAM,CAAAI,MAAM,CAAG/B,WAAW,CAC1BD,MAAM,CAACiC,IAAI,CAAC,cAAc,CAAED,MAAM,CAAEnC,OAAO,CAAEQ,IAAI,CAAEyB,IAAI,CAAET,SAAS,CAAC,CACnEvB,UAAU,CAAC,EAAE,CAAC,CAChB,CAGE,mBACER,KAAA,CAAAE,SAAA,EAAA0C,QAAA,eACQ5C,KAAA,QAAK6C,SAAS,CAAC,iBAAiB,CAAAD,QAAA,EAC/B7B,IAAI,EAAI,EAACD,gBAAgB,SAAhBA,gBAAgB,WAAhBA,gBAAgB,CAAEgC,GAAG,GAAInC,WAAW,CAACiB,MAAM,EAAI,CAAC,eAAG9B,IAAA,QAAK+C,SAAS,CAAC,kBAAkB,CAAAD,QAAA,CAAC,cAAY,CAAK,CAAC,CAChH7B,IAAI,EAAI,EAACD,gBAAgB,SAAhBA,gBAAgB,WAAhBA,gBAAgB,CAAEgC,GAAG,GAAInC,WAAW,CAACiB,MAAM,GAAK,CAAC,eAAG5B,KAAA,QAAK6C,SAAS,CAAC,kBAAkB,CAAAD,QAAA,EAAC,iBAAe,CAACjC,WAAW,CAAC,OAAK,EAAK,CAAC,CAClII,IAAI,GAAID,gBAAgB,SAAhBA,gBAAgB,iBAAhBA,gBAAgB,CAAEgC,GAAG,gBAC1BhD,IAAA,CAAAI,SAAA,EAAA0C,QAAA,cACI9C,IAAA,QAAK+C,SAAS,CAAC,oCAAoC,CAAAD,QAAA,cAC/C5C,KAAA,QAAA4C,QAAA,EAAK,yBACsB,CAAC9B,gBAAgB,CAACiC,IAAI,CAAC,GAAC,cAAAjD,IAAA,QAAKkD,GAAG,CAAElC,gBAAgB,CAACmC,OAAQ,CAACJ,SAAS,CAAC,0BAA0B,CAAE,CAAC,EACzH,CAAC,CACL,CAAC,CACR,CACL,CACA,CAAC9B,IAAI,eAAIjB,IAAA,QAAK+C,SAAS,CAAC,oBAAoB,CAAAD,QAAA,CAAC,cAAY,CAAK,CAAC,CAE/D7B,IAAI,EACDF,QAAQ,CAACqC,GAAG,CAAC,SAAAC,IAAA,CAAgCC,GAAG,KAA3B,CAAA/B,IAAI,CAAA8B,IAAA,CAATL,GAAG,CAAQO,cAAc,CAAAF,IAAA,CAAdE,cAAc,oBACvCrD,KAAA,QAAA4C,QAAA,eACA9C,IAAA,MAAG+C,SAAS,CAAC,qDAAqD,CAAAD,QAAA,CAAEvB,IAAI,CAAI,CAAC,CAC5EgC,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAEH,GAAG,CAAC,SAAAI,KAAA,CAAkCC,MAAM,KAArC,CAAAC,OAAO,CAAAF,KAAA,CAAPE,OAAO,CAAEhB,IAAI,CAAAc,KAAA,CAAJd,IAAI,CAAQiB,MAAM,CAAAH,KAAA,CAAZI,IAAI,oBACvC5D,IAAA,QAAK+C,SAAS,CAAE,CAAAY,MAAM,SAANA,MAAM,iBAANA,MAAM,CAAEE,KAAK,IAAI5C,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAE4C,KAAK,EAAG,SAAS,CAAG,kBAAmB,CAAAf,QAAA,cAC1E5C,KAAA,QAAK6C,SAAS,CAAC,eAAe,CAAAD,QAAA,eAC1B5C,KAAA,QAAK6C,SAAS,CAAC,gCAAgC,CAAAD,QAAA,eAC3C9C,IAAA,QAAKkD,GAAG,CAAES,MAAM,CAACR,OAAQ,CAACW,KAAK,CAAE,CAAEC,KAAK,CAAE,EAAE,CAAEC,MAAM,CAAE,EAAE,CAAEC,SAAS,CAAE,OAAO,CAAEC,YAAY,CAAE,KAAK,CAAEC,WAAW,CAAE,EAAG,CAAE,CAAE,CAAC,cACxHnE,IAAA,MAAG+C,SAAS,CAAC,gBAAgB,CAAAD,QAAA,CAAEa,MAAM,CAACX,GAAG,GAAI/B,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAE+B,GAAG,EAAG,KAAK,CAAGW,MAAM,CAACV,IAAI,CAAI,CAAC,EAChF,CAAC,cACNjD,IAAA,MAAG+C,SAAS,CAAC,iBAAiB,CAAAD,QAAA,CAAEY,OAAO,CAAI,CAAC,cAC5C1D,IAAA,MAAG+C,SAAS,CAAC,wBAAwB,CAAAD,QAAA,CAAEJ,IAAI,CAAI,CAAC,EAC/C,CAAC,EAR0Ee,MAS/E,CAAC,EACT,CAAC,GAbQH,GAcT,CAAC,EACT,CAAC,EAEL,CAAC,cACAtD,IAAA,CAACL,IAAI,EAACyE,QAAQ,CAAEjD,YAAa,CAAA2B,QAAA,cAC3B5C,KAAA,CAACN,GAAG,EAAAkD,QAAA,eACJ9C,IAAA,CAACN,GAAG,EAAC2E,EAAE,CAAE,EAAG,CAAAvB,QAAA,cACV9C,IAAA,CAACL,IAAI,CAAC2E,KAAK,EAAAxB,QAAA,cACT9C,IAAA,CAACL,IAAI,CAAC4E,OAAO,EAACC,IAAI,CAAC,MAAM,CAACC,WAAW,CAAC,cAAc,CAACC,QAAQ,CAAE,CAACzD,IAAK,CAAC0D,KAAK,CAAElE,OAAQ,CAACmE,QAAQ,CAAE,SAAAA,SAACxD,CAAC,QAAK,CAAAV,UAAU,CAACU,CAAC,CAACyD,MAAM,CAACF,KAAK,CAAC,EAAC,CAGpH,CAAC,CACL,CAAC,CACV,CAAC,cACN3E,IAAA,CAACN,GAAG,EAAC2E,EAAE,CAAE,CAAE,CAAAvB,QAAA,cACX9C,IAAA,CAACP,MAAM,EAACqF,OAAO,CAAC,SAAS,CAACN,IAAI,CAAC,QAAQ,CAACV,KAAK,CAAE,CAAEC,KAAK,CAAE,MAAM,CAAEgB,eAAe,CAAE,QAAS,CAAE,CAACL,QAAQ,CAAE,CAACzD,IAAK,CAAA6B,QAAA,cAC7G9C,IAAA,MAAG+C,SAAS,CAAC,oBAAoB,CAAI,CAAC,CAC9B,CAAC,CACJ,CAAC,EACD,CAAC,CACF,CAAC,EAIT,CAAC,CAEX,CAAC,CAED,cAAe,CAAA1C,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}