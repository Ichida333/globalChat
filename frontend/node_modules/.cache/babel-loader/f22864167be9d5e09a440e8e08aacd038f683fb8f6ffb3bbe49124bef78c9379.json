{"ast":null,"code":"import React,{useContext,useEffect}from\"react\";import{Col,ListGroup,Row}from\"react-bootstrap\";import\"./Sidebar.css\";import{useSelector,useDispatch}from\"react-redux\";import{AppContext}from\"../context/appContext\";import{addNotifications,resetNotifications}from\"../features/userSlice\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Sidebar=function Sidebar(){var user=useSelector(function(state){return state.user;});var dispatch=useDispatch();var _useContext=useContext(AppContext),socket=_useContext.socket,setMembers=_useContext.setMembers,members=_useContext.members,setCurrentRoom=_useContext.setCurrentRoom,setRooms=_useContext.setRooms,privateMemberMsg=_useContext.privateMemberMsg,rooms=_useContext.rooms,setPrivateMemberMsg=_useContext.setPrivateMemberMsg,currentRoom=_useContext.currentRoom;var joinRoom=function joinRoom(room){var isPublic=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(!user){return alert(\"Please login\");}socket.emit(\"join-room\",room);setCurrentRoom(room);if(isPublic){setPrivateMemberMsg(null);}// dispatch for notifications\ndispatch(resetNotifications(room));};socket.off(\"notifications\").on(\"notifications\",function(room){if(currentRoom!=room)dispatch(addNotifications(room));});useEffect(function(){if(user){getRooms();// socket.emit(\"join-room\", \"general\");\nsocket.emit(\"new-user\");console.log(currentRoom);}},[]);socket.off(\"new-user\").on(\"new-user\",function(payload){setMembers(payload);});function orderIds(id1,id2){if(id1>id2){return id1+\"-\"+id2;}else{return id2+\"-\"+id1;}}var hanldePrivateMenberMsg=function hanldePrivateMenberMsg(member){setPrivateMemberMsg(member);var roomId=orderIds(user._id,member._id);joinRoom(roomId,false);};function getRooms(){fetch(\"http://localhost:5001/rooms\").then(function(res){return res.json();}).then(function(data){return setRooms(data);});}if(!user){return/*#__PURE__*/_jsx(_Fragment,{});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Available rooms\"}),/*#__PURE__*/_jsx(ListGroup,{children:rooms.map(function(room,idx){return/*#__PURE__*/_jsxs(ListGroup.Item,{onClick:function onClick(){return joinRoom(room);},active:room==currentRoom,style:{cursor:\"pointer\",display:\"flex\",justifyContent:\"space-between\"},children:[room,\" \",currentRoom!==room&&/*#__PURE__*/_jsx(\"span\",{className:\"badge rounded-pill bg-primary\",children:user.newMessages[room]})]},idx);})}),/*#__PURE__*/_jsx(\"h2\",{children:\"Membars\"}),/*#__PURE__*/_jsx(ListGroup,{children:members.map(function(member){return/*#__PURE__*/_jsx(ListGroup.Item,{style:{cursor:\"pointer\"},active:(privateMemberMsg===null||privateMemberMsg===void 0?void 0:privateMemberMsg._id)===(member===null||member===void 0?void 0:member._id),onClick:function onClick(){return hanldePrivateMenberMsg(member);},disabled:member._id===user._id,children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{xs:2,className:\"member-status\",children:/*#__PURE__*/_jsx(\"img\",{src:member.picture,className:\"member-status-img\"})}),/*#__PURE__*/_jsxs(Col,{xs:9,children:[member.name,member._id===(user===null||user===void 0?void 0:user._id)&&\" (You)\",member.status==\"offline\"&&\" (Offline)\"]}),/*#__PURE__*/_jsx(Col,{xs:1,children:/*#__PURE__*/_jsx(\"span\",{className:\"badge rounded-pill bg-primary\",children:user.newMessages[orderIds(member._id,user._id)]})})]})},member._id);})})]});};export default Sidebar;","map":{"version":3,"names":["React","useContext","useEffect","Col","ListGroup","Row","useSelector","useDispatch","AppContext","addNotifications","resetNotifications","Fragment","_Fragment","jsx","_jsx","jsxs","_jsxs","Sidebar","user","state","dispatch","_useContext","socket","setMembers","members","setCurrentRoom","setRooms","privateMemberMsg","rooms","setPrivateMemberMsg","currentRoom","joinRoom","room","isPublic","arguments","length","undefined","alert","emit","off","on","getRooms","console","log","payload","orderIds","id1","id2","hanldePrivateMenberMsg","member","roomId","_id","fetch","then","res","json","data","children","map","idx","Item","onClick","active","style","cursor","display","justifyContent","className","newMessages","disabled","xs","src","picture","name","status"],"sources":["/Users/ichidayu/globalChat/frontend/src/components/Sidebar.js"],"sourcesContent":["import React, { useContext, useEffect } from \"react\";\nimport { Col, ListGroup, Row } from \"react-bootstrap\";\nimport \"./Sidebar.css\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { AppContext } from \"../context/appContext\";\nimport { addNotifications, resetNotifications } from \"../features/userSlice\";\n\nconst Sidebar = () => {\n  const user = useSelector((state) => state.user);\n  const dispatch = useDispatch();\n  const { socket, setMembers, members, setCurrentRoom, setRooms, privateMemberMsg, rooms, setPrivateMemberMsg, currentRoom } = useContext(AppContext);\n\n  const joinRoom = (room, isPublic = true) => {\n    if(!user){\n      return alert(\"Please login\");\n     }\n     socket.emit(\"join-room\" ,room);\n     setCurrentRoom(room);\n\n     if(isPublic) {\n       setPrivateMemberMsg(null);\n     }\n\n     // dispatch for notifications\n     dispatch(resetNotifications(room));\n\n  }\n\n  socket.off(\"notifications\").on(\"notifications\", (room) => {\n    if (currentRoom != room) dispatch(addNotifications(room));\n})\n\n  useEffect(() => {\n    if (user) {\n  \n       \n         getRooms();\n        // socket.emit(\"join-room\", \"general\");\n        socket.emit(\"new-user\");\n        console.log(currentRoom)\n    }\n  }, []);\n  \n  socket.off(\"new-user\").on(\"new-user\", (payload) => {\n    setMembers(payload);\n  });\n\n  function orderIds(id1, id2) {\n    if (id1 > id2) {\n        return id1 + \"-\" + id2;\n    } else {\n        return id2 + \"-\" + id1;\n    }\n}\n\n\n  const hanldePrivateMenberMsg = (member) => {\n    setPrivateMemberMsg(member);\n    const roomId = orderIds(user._id, member._id);\n        joinRoom(roomId, false);\n\n  }\n\n\n\n\nfunction getRooms() {\n  fetch(\"http://localhost:5001/rooms\")\n      .then((res) => res.json())\n      .then((data) => setRooms(data));\n}\n\nif (!user) {\n  return <></>;\n}\n  return (\n    <>\n       <h2>Available rooms</h2>\n       <ListGroup>\n       {rooms.map((room, idx) => (\n         <ListGroup.Item key={idx} onClick={() => joinRoom(room) } active={room == currentRoom} style={{ cursor: \"pointer\", display: \"flex\", justifyContent: \"space-between\" }}>\n           {room} {currentRoom !== room && <span className=\"badge rounded-pill bg-primary\">{user.newMessages[room]}</span>}</ListGroup.Item>\n           ))}\n       </ListGroup>\n       <h2>Membars</h2>\n       <ListGroup>\n       {members.map((member) => (\n         <ListGroup.Item key={member._id} style={{ cursor: \"pointer\"}} active={privateMemberMsg?._id === member?._id} onClick={() => hanldePrivateMenberMsg(member)} disabled={member._id === user._id}>\n           <Row>\n                        <Col xs={2} className=\"member-status\">\n                            <img src={member.picture} className=\"member-status-img\" />\n                            {/* {member.status == \"online\" ? <i className=\"fas fa-circle sidebar-online-status\"></i> : <i className=\"fas fa-circle sidebar-offline-status\"></i>} */}\n                        </Col>\n                        <Col xs={9}>\n                            {member.name}\n                            {member._id === user?._id && \" (You)\"}\n                            {member.status == \"offline\" && \" (Offline)\"}\n                        </Col>\n                        <Col xs={1}>\n                            <span className=\"badge rounded-pill bg-primary\">{user.newMessages[orderIds(member._id, user._id)]}</span>\n                        </Col>\n                    </Row>\n          \n         </ListGroup.Item>\n        \n       ))}\n        </ListGroup>\n      \n    </>\n  )\n}\n\nexport default Sidebar\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}